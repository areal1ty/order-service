# Order Service API

Order Service API — это RESTful API для управления заказами, реализованное на Rust с использованием фреймворка Axum и взаимодействием с PostgreSQL и Redis. Основная цель API — предоставить эффективный и быстрый способ работы с заказами, используя базы данных и кэш для оптимизации.

## Основные функции и фичи

- **Создание заказа**: Возможность создавать заказы с деталями о доставке, оплате и товарах.
- **Получение заказа**: Получение данных о заказе через его уникальный идентификатор (`order_uid`).
- **Кэширование заказов**: Данные о заказах кэшируются в Redis для повышения производительности при повторных запросах.
- **Транзакционная работа с базой данных**: Взаимодействие с PostgreSQL происходит в рамках транзакций, обеспечивая целостность данных.
- **Обработка командной строки**: Возможность загрузки тестовых данных в базу через командную строку.

## Технические решения

### Axum

Для создания API используется фреймворк Axum. Axum упрощает создание маршрутов и обработку запросов, а также интеграцию с асинхронными базами данных и Redis.

### PostgreSQL

Для хранения данных о заказах используется PostgreSQL. Все взаимодействия с базой данных осуществляются через библиотеку `sqlx`, которая позволяет выполнять запросы в асинхронном режиме и поддерживает работу с транзакциями.

### Redis

Redis используется как кэш для хранения данных о заказах. Это позволяет ускорить доступ к часто запрашиваемым данным, что значительно повышает производительность системы.

### Структура проекта

Проект организован по модульному принципу, что улучшает читаемость и масштабируемость кода:

- **routes/** — маршруты API, такие как `get_order`.
- **handlers/** — логика обработки запросов и взаимодействие с базой данных.
- **db/** — работа с PostgreSQL.
- **cache/** — работа с Redis.
- **scripts/** — утилиты для заполнения базы данных тестовыми данными и очистки данных.

### Логирование

Логирование запросов и ошибок реализовано с использованием `tracing` и `tower-http::trace`, что позволяет отслеживать обработку запросов и выявлять проблемы на сервере.

## Команды командной строки

Проект поддерживает команды для управления данными в базе данных. Например, вы можете загружать тестовые данные или очищать таблицы.

### Загрузка тестовых данных

```bash
cargo run --bin load_data
```
### Получение заказа
Для получения заказа используйте GET-запрос на /orders/:order_uid, где order_uid — уникальный идентификатор заказа:

```bash
curl -X GET /orders/{id}
Ответ будет в формате JSON с данными о заказе.
```

### Настройка
Проект использует следующие переменные окружения, которые нужно настроить перед запуском:

DATABASE_URL: URL для подключения к PostgreSQL.

REDIS_URL: URL для подключения к Redis.
